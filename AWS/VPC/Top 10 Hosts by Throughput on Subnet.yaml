- defaultTab: nodes
  description: Query CloudWatch logs using Logs Insights to identify the top 10 hosts
    by throughput on a given subnet
  executionEnabled: true
  group: AWS/VPC
  id: 7ce595c9-16ec-4c47-8fb1-e23af4771046
  loglevel: INFO
  name: Top 10 Hosts by Throughput on Subnet
  nodeFilterEditable: false
  options:
  - description: The name of the CloudWatch log group to query where the VPC flow
      logs reside.
    label: CloudWatch Log Grop Name
    name: cloudwatch_log_group
    required: true
    value: vpc-flow-logs-group
  - description: The AWS Region where the CloudWatch logs reside.
    label: AWS Region
    name: region
    required: true
    value: us-east-1
  - description: The subnet within the VPC to search for high throughput hosts.
    label: VPC Subnet
    name: subnet
    value: 192.0.2.0/24
  plugins:
    ExecutionLifecycle: {}
  scheduleEnabled: true
  schedules: []
  sequence:
    commands:
    - configuration:
        '0': '5'
        cloudWatchLogGroup: ${option.cloudwatch_log_group}
        queryString: "filter isIpv4InSubnet(srcAddr, \"${option.subnet}\")\n    |\
          \ stats sum(bytes) as bytesTransferred by dstAddr\n    | sort bytesTransferred\
          \ desc\n    | limit 10\n     \n    "
        region: ${option.region}
        timeUnit: Hours
      description: Query CloudWatch Logs for Top Hosts by Throughput
      nodeStep: false
      type: aws-query-cloudwatch-logs-step
    keepgoing: false
    strategy: node-first
  uuid: 7ce595c9-16ec-4c47-8fb1-e23af4771046

